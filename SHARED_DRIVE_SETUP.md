# üö® Shared Drive Setup Required

## The Issue

You're seeing this error:
```
Service Accounts do not have storage quota. Leverage shared drives instead.
```

**Root Cause**: Service accounts cannot upload files to regular Google Drive folders. They can only upload to:
1. **Shared Drives** (Google Workspace required)
2. Their own Drive space (not visible in your Drive)

---

## Solution: Set Up a Shared Drive

### Requirements
- **Google Workspace account** (Business Starter, Business Standard, Business Plus, or Enterprise)
- **Not available** for free Gmail accounts

### Steps

1. **Go to Google Drive**
   - Visit [drive.google.com](https://drive.google.com)

2. **Access Shared Drives**
   - Click **"Shared drives"** in the left sidebar
   - If you don't see this option, you don't have Google Workspace

3. **Create New Shared Drive**
   - Click the **"New"** button (+ icon)
   - Name it: `Diligence` (or your preferred name)
   - Click **"Create"**

4. **Add Service Account**
   - In the new Shared Drive, click **"Manage members"**
   - Click **"Add members"**
   - Paste your service account email:
     ```
     your-service-account@your-project.iam.gserviceaccount.com
     ```
   - Set permission level: **"Content Manager"** or **"Manager"**
   - Uncheck "Notify people" (service accounts don't receive emails)
   - Click **"Send"**

5. **Get Shared Drive ID**
   - Open the Shared Drive you just created
   - Copy the ID from the URL:
     ```
     https://drive.google.com/drive/folders/SHARED_DRIVE_ID_HERE
     ```
   - Copy just the `SHARED_DRIVE_ID_HERE` part

6. **Update .env.local**
   ```bash
   GOOGLE_DRIVE_FOLDER_ID=your_shared_drive_id_here
   ```

7. **Restart Dev Server**
   ```bash
   npm run dev
   ```

---

## Alternative: Use Service Account's Own Drive

If you **don't have Google Workspace**, you can use the service account's own Drive:

1. **Update .env.local**
   ```bash
   GOOGLE_DRIVE_FOLDER_ID=root
   ```

2. **Restart Dev Server**
   ```bash
   npm run dev
   ```

**Trade-offs:**
- ‚úÖ No Google Workspace required
- ‚úÖ Files are uploaded successfully
- ‚ùå Files won't appear in your personal Google Drive
- ‚ùå You can only access files via the shared links generated by the app

---

## Verify It's Working

After setup:

1. Go to `/diligence/new`
2. Upload a test document
3. You should see:
   - ‚úÖ "Documents uploaded successfully!"
   - ‚úÖ File appears in your Shared Drive (if using Option 1)
   - ‚úÖ AI scoring begins automatically

---

## Troubleshooting

### "Shared drives" option not visible
- **Cause**: You don't have Google Workspace
- **Solution**: Use the alternative method (set `GOOGLE_DRIVE_FOLDER_ID=root`)

### "Permission denied" error
- **Cause**: Service account doesn't have access to the Shared Drive
- **Solution**: Re-add the service account with "Content Manager" permissions

### Files still not uploading
- **Cause**: Old folder ID still in `.env.local`
- **Solution**: Double-check you updated `GOOGLE_DRIVE_FOLDER_ID` and restarted the server

---

## Need Help?

- Full setup guide: [DILIGENCE_SETUP_GUIDE.md](./DILIGENCE_SETUP_GUIDE.md)
- Quick start: [DILIGENCE_QUICK_START.md](./DILIGENCE_QUICK_START.md)
- Testing guide: [DILIGENCE_TESTING_GUIDE.md](./DILIGENCE_TESTING_GUIDE.md)
